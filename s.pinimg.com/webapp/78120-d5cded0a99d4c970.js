"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[78120],{337148:function(e){var t,n,o={fragment:{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StelaOnIdeaPinPermissionQuery",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"v3GetCurrentUserHandlerQuery",plural:!1,selections:[{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"data",plural:!1,selections:[t={kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"ipStelaRecDisabled",storageKey:null}],type:"User",abstractKey:null}],storageKey:null}],type:"V3GetCurrentUserHandler",abstractKey:null}],storageKey:null}],type:"Query",abstractKey:null},kind:"Request",operation:{argumentDefinitions:[],kind:"Operation",name:"StelaOnIdeaPinPermissionQuery",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"v3GetCurrentUserHandlerQuery",plural:!1,selections:[n={alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null},{kind:"InlineFragment",selections:[{alias:null,args:null,concreteType:null,kind:"LinkedField",name:"data",plural:!1,selections:[n,t,{kind:"InlineFragment",selections:[{alias:null,args:null,kind:"ScalarField",name:"id",storageKey:null}],type:"Node",abstractKey:"__isNode"}],storageKey:null}],type:"V3GetCurrentUserHandler",abstractKey:null}],storageKey:null}]},params:{id:"2653a6ed13b2a48a0adbce54781b1b88b025b8bd93a112b8a0bd15da606dcbe9",metadata:{},name:"StelaOnIdeaPinPermissionQuery",operationKind:"query",text:null}};o.hash="c061d1400492f868408772f86f659738",e.exports=o},857752:function(e,t,n){n.d(t,{Z:function(){return d}});var o=n(194249),r=n(167678),i=n(515198);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=(0,r.ZP)({resolved:{},chunkName:function(){return"EditorWithMentionsInternal"},isReady:function(e){var t=this.resolve(e);return!0===this.resolved[t]&&!!n.m[t]},importAsync:function(){return Promise.all([n.e(62823),n.e(35978)]).then(n.bind(n,400049))},requireAsync:function(e){var t=this,n=this.resolve(e);return this.resolved[n]=!1,this.importAsync(e).then((function(e){return t.resolved[n]=!0,e}))},requireSync:function e(t){var o=this.resolve(t);return n(o)},resolve:function e(){return 400049}});function d(e){return(0,i.jsx)(c,l(l({},e),{},{fallback:(0,i.jsx)(o.Z,{})}))}},194249:function(e,t,n){n.d(t,{Z:function(){return a}});var o=n(898781),r=n(908390),i=n(515198);function a(){var e=(0,o.ZP)();return(0,i.jsx)(r.kC,{alignItems:"center",justifyContent:"center",children:(0,i.jsx)(r.$j,{accessibilityLabel:e._('Loading editor', 'EditorWithMentionsFallback.loading', 'Message shown while waiting for the editor to load'),show:!0})})}},43898:function(e,t,n){n.d(t,{Z:function(){return i}});var o=n(908390),r=n(515198);function i(e){var t=e.htmlFor,n=e.errorMessage;return(0,r.jsx)(o.__,{htmlFor:t,children:(0,r.jsx)(o.xu,{marginTop:1,children:(0,r.jsx)(o.xv,{color:"error",size:"200",children:n})})})}},897103:function(e,t,n){n.d(t,{Z:function(){return k}});var o=n(76911),r=n(506979),i=n(488769),a=n(27255),l=n(654287),s=n(984206),c=n(109892),d=n(717615),u=n(784590),p=n(19121),h=n(615298),f=n(507016),_=n(231947),g=n(414327),b=n(898781),y=n(908390),v=n(515198);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){E(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=A(e);if(t){var r=A(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return C(this,n)}}function C(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return O(e)}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function D(e){var t=e.board,n=e.hovered,o=e.searchQuery,r=t.privacy===a.Z.BoardPrivacy.SECRET;return(0,v.jsxs)(y.xu,{color:n?"secondary":"default",display:"flex",padding:2,rounding:2,children:[(0,v.jsx)(y.xu,{flex:"grow",children:(0,v.jsx)(y.xv,{weight:"bold",children:(0,f.W)(o,t.name)})}),(0,v.jsxs)(y.kC,{alignItems:"stretch",justifyContent:"start",direction:"row",flex:"none",children:[r&&(0,v.jsx)(i.Z,{type:"secret"}),t.is_collaborative&&(0,v.jsx)(i.Z,{type:"group"})]})]})}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(i,e);var t,n,o,r=S(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),E(O(t=r.call(this,e)),"getSections",(function(){var e;if(null===(e=t.props.boardResource.data)||void 0===e||!e.all_boards)return[];var n=t.state.searchQuery,o=t.props.boardResource.data.all_boards;return n.length>=s.Z?[{items:(0,h.j)(o,n)}]:[{items:o}]})),E(O(t),"createBtnDisabled",(function(){var e;if(null===(e=t.props.boardResource.data)||void 0===e||!e.all_boards)return!1;var n=t.props.boardResource.data.all_boards,o=t.state.searchQuery;return n.some((function(e){var t;return(null===(t=e.name)||void 0===t?void 0:t.toLowerCase())===o.toLowerCase()}))})),E(O(t),"handleBoardCreate",(function(e){return function(){var e=t.state.searchQuery;if(e){var n=t.props,o=n.createBoard,r=n.invalidateBoardPickerBoardsResource,i=n.onBoardCreate;r(),i?i(e):o({name:e,privacy:"public"}).then((function(e){(0,t.props.onBoardChosen)(e)}))}}})),E(O(t),"handleBoardSelected",(function(e){t.props.onBoardChosen(e),t.setState({selectedBoard:e})})),E(O(t),"handleSearchQueryUpdate",(function(e){t.setState({searchQuery:e})})),E(O(t),"renderRow",(function(e){var n=e.item,o=e.hovered,r=t.state.searchQuery;return(0,v.jsx)(D,{board:n,hovered:o,searchQuery:r})})),t.state={searchQuery:"",selectedBoard:e.board},t}return t=i,(n=[{key:"render",value:function(){var e=this.props,t=e.boardResource,n=e.board,o=e.isBoardlessPinsBoard,r=e.isQuickCreatesBoard,i=e.isStoryPin,a=e.viewer,s=this.state,c=s.searchQuery,d=s.selectedBoard,u=this.props.i18n._('Select a board', 'Label for selecting a board in Edit Pin Modal', 'Label for selecting a board in Edit Pin Modal');return n?u=r?this.props.i18n._('Choose board', 'BoardPickerFlyout.displayBoardName.quickCreatesBoard', 'Title for board picker when current board is a quick creates board'):o?this.props.i18n._('Profile', 'BoardPickerFlyout.displayBoarName.boardlessPins', 'Title indicating the pin is saved to profile'):n.name:d&&(u=d.name),(0,v.jsxs)(y.xu,{children:[(0,v.jsx)(y.$j,{accessibilityLabel:this.props.i18n._('loading board picker', 'accessibility text for loading spinner', 'accessibility text for loading spinner'),show:!t.isLoaded}),t.data&&(0,v.jsx)(l.Z,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:u||"",isStoryPin:i,onCreate:this.handleBoardCreate(a),onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleBoardSelected,renderRow:this.renderRow,searchQuery:c,sections:this.getSections(),blockBoardChange:null==n?void 0:n.is_ads_only})]})}}])&&P(t.prototype,n),o&&P(t,o),i}(o.Component);function k(e){var t=(0,c.Z)(),n=(0,b.ZP)(),o=(0,r.useDispatch)(),i=(0,p.Z)(),a=(0,r.useSelector)((function(e){return e.advertiser})),l=i.isAuth&&a&&a.owner_user_id!==i.id,s=l?a.id:null,h=l?a.owner_user_id:null,f=(0,d.Z)(),y=(0,_.Ms)(i,f),m=y||h,x=(0,u.Z)({name:"BoardPickerBoardsResource",options:j({pin_id:e.pinId,field_set_key:"board_picker",onlyFetchBoards:!0,username:m},s&&h?{advertiser_id:s,filter:"protected",username:h}:{}),noCache:!0});return(0,v.jsx)(z,j(j({},e),{},{advertiser_id:s,boardResource:x,createBoard:function(e){return t({boardCreateOptions:e})},invalidateBoardPickerBoardsResource:function(){o((0,g.jB)("BoardPickerBoardsResource",j({field_set_key:"board_picker"},y?{username:y}:{username:h})))},username:h,viewer:i,i18n:n}))}},654287:function(e,t,n){n.d(t,{Z:function(){return P}});var o=n(76911),r=n(176020),i=n(33897),a=n(960260),l=n(887831),s=n(898781),c=n(908390),d=n(515198);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function g(e,t){return(g=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=m(e);if(t){var r=m(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return y(this,n)}}function y(e,t){if(t&&("object"===u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return v(e)}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function x(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var j=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&g(e,t)}(s,e);var t,n,o,l=b(s);function s(){var e;f(this,s);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return x(v(e=l.call.apply(l,[this].concat(n))),"state",{showFlyout:!1}),x(v(e),"setContainerRef",(function(t){e.containerRef=t})),x(v(e),"handleCreate",(function(){e.hideFlyout();var t=e.props.onCreate;t&&t()})),x(v(e),"handleSelectItem",(function(t){e.hideFlyout();var n=e.props,o=n.onSelect,r=n.onCreate;t?o(t):r&&r()})),x(v(e),"handleDropdownTouch",(function(){e.setState((function(e){return{showFlyout:!e.showFlyout}}))})),x(v(e),"handleHideFlyout",(function(t){e.containerRef&&t.target instanceof HTMLElement&&!e.containerRef.contains(t.target)&&e.hideFlyout()})),x(v(e),"hideFlyout",(function(){(0,e.props.hoverHandlers.onMouseLeave)(),e.setState({showFlyout:!1})})),e}return t=s,(n=[{key:"componentDidMount",value:function(){document.addEventListener("click",this.handleHideFlyout,{capture:!0})}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.handleHideFlyout,{capture:!0})}},{key:"render",value:function(){var e=this.props,t=e.dropdownValue,n=e.fetchMore,o=e.hoverHandlers,l=o.onMouseOver,s=o.onMouseLeave,u=e.isHovering,p=e.isStoryPin,h=e.onCreate,f=e.onSearchQueryUpdate,_=e.renderRow,g=e.searchQuery,b=e.sections,y=e.createBtnDisabled,v=e.blockBoardChange,m=this.state.showFlyout;this.indexManager=new r.Z(b.map((function(e){return e.items}))),this.indexManager.setSelectItem(this.handleSelectItem);var x=!g.trim()||!!y;return(0,d.jsxs)(c.xu,{ref:this.setContainerRef,flex:p?"grow":void 0,children:[(0,d.jsx)(c.iP,{fullWidth:!!p,onMouseEnter:l,onMouseLeave:s,onTap:this.handleDropdownTouch,rounding:2,disabled:!!v,children:(0,d.jsxs)(c.xu,{alignItems:"center",color:u?"lightWash":"secondary",direction:"row",display:"flex",flex:"grow",paddingX:4,paddingY:p?4:3,rounding:p?4:2,children:[(0,d.jsx)(c.kC,{alignItems:"stretch",justifyContent:"start",flex:"grow",children:(0,d.jsx)(c.xv,{weight:"bold",color:v?"subtle":"default",children:t})}),v?(0,d.jsx)(c.JO,{accessibilityLabel:"",color:"subtle",icon:"arrow-down",size:14}):(0,d.jsx)(c.JO,{accessibilityLabel:"",color:"default",icon:"arrow-down",size:14})]})}),m&&(0,d.jsx)(c.xu,{position:"relative",children:(0,d.jsxs)(c.xu,{borderStyle:"sm",color:"default",direction:"column",display:"flex",overflow:"hidden",position:"absolute",rounding:p?4:2,width:"100%",zIndex:new c.Ry(1),children:[(0,d.jsx)(c.xu,{children:(0,d.jsxs)(c.xu,{display:"flex",marginStart:-1,marginEnd:-1,padding:2,children:[(0,d.jsx)(c.xu,{display:"flex",flex:"grow",paddingX:1,children:(0,d.jsx)(i.Z,{hideIcon:!0,indexManager:this.indexManager,onChange:f,value:g})}),h&&(0,d.jsx)(c.xu,{paddingX:1,children:(0,d.jsx)(c.zx,{disabled:x,onClick:this.handleCreate,text:this.props.i18n._('Create', 'board or section dropdown create button', 'board or section dropdown create button')})})]})}),(0,d.jsx)(a.Z,{fetchMore:n,indexManager:this.indexManager,maxHeight:240,onSelectItem:this.handleSelectItem,renderItem:_,sections:b})]})})]})}}])&&_(t.prototype,n),o&&_(t,o),s}(o.Component);function P(e){var t=(0,s.ZP)(),n=(0,l.Z)(),o=n.isHovering,r=n.hoverHandlers;return(0,d.jsx)(j,h(h({},e),{},{i18n:t,isHovering:o,hoverHandlers:r}))}},241563:function(e,t,n){n.d(t,{Z:function(){return z},x:function(){return D}});var o=n(76911),r=n(506979),i=n(654287),a=n(984206),l=n(784590),s=n(678638),c=n(615298),d=n(507016),u=n(898781),p=n(908390),h=n(515198);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function b(e){return function(e){if(Array.isArray(e))return y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return y(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function v(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function x(e,t){return(x=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function j(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=S(e);if(t){var r=S(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return P(this,n)}}function P(e,t){if(t&&("object"===f(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return w(e)}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var O="NO_SECTION_VALUE";function A(e){var t=e.section,n=e.hovered,o=e.searchQuery;return(0,h.jsxs)(p.xu,{children:[(0,h.jsx)(p.xu,{color:n?"secondary":"default",display:"flex",padding:2,rounding:2,children:(0,h.jsx)(p.xu,{flex:"grow",children:(0,h.jsx)(p.xv,{weight:"bold",children:(0,d.W)(o,t.title)})})}),t.id===O&&(0,h.jsx)(p.iz,{})]})}var E=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&x(e,t)}(l,e);var t,n,o,r=j(l);function l(){var e;v(this,l);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return C(w(e=r.call.apply(r,[this].concat(n))),"state",{searchQuery:""}),C(w(e),"getPickerSections",(function(){var t=e.state.searchQuery,n=e.props,o=n.sectionsResource,r=n.mergingFromSectionId,i=o&&o.data||[];return i=r?i.filter((function(e){return e.id!==r})):[{id:O,title:e.props.i18n._('No section', 'default dropdown option for selecting a board section on pin edit', 'default dropdown option for selecting a board section on pin edit')}].concat(b(i)),t.length>=a.Z&&(i=(0,c.j)(i,t,"title")),[{items:i}]})),C(w(e),"createBtnDisabled",(function(){var t=e.props.sectionsResource,n=e.state.searchQuery;return!(!t||!t.data)&&t.data.some((function(e){var t;return(null===(t=e.title)||void 0===t?void 0:t.toLowerCase())===n.toLocaleLowerCase()}))})),C(w(e),"handleSectionCreate",(function(){var t=e.props,n=t.board,o=t.onSectionChange,r=t.sectionsResource,i=t.dispatch,a=t.onSectionCreate,l=e.state.searchQuery;a?a(l):i&&n.id&&i((0,s.vB)({boardId:n.id,name:l},e.props.i18n)).then((function(t){r&&r.refresh(),e.setState({searchQuery:""}),o(t)}))})),C(w(e),"handleSectionSelected",(function(t){var n=e.props.onSectionChange;t.id===O?(n(null),e.setState({searchQuery:""})):(n(t),e.setState({searchQuery:""}))})),C(w(e),"handleSearchQueryUpdate",(function(t){e.setState({searchQuery:t})})),C(w(e),"renderRow",(function(t){var n=t.item,o=t.hovered,r=e.state.searchQuery;return(0,h.jsx)(A,{hovered:o,searchQuery:r,section:n})})),e}return t=l,(n=[{key:"componentDidUpdate",value:function(e){var t=e.selectedSectionId;if(this.props.selectedSectionId!==t){var n=this.props.sectionsResource;n&&n.refresh()}}},{key:"render",value:function(){var e,t=this.props,n=t.isStoryPin,o=t.sectionsResource,r=t.selectedSectionId,a=t.mergingFromSectionId,l=t.selectedSectionName,s=this.state.searchQuery,c=a?this.props.i18n._('Pick a section', 'default dropdown option for selecting a board section to merge to', 'default dropdown option for selecting a board section to merge to'):this.props.i18n._('No section', 'default dropdown option for selecting a board section on pin edit', 'default dropdown option for selecting a board section on pin edit');return r?(o&&o.data&&(e=o.data.find((function(e){return e.id===r}))),c=e&&e.title||c):l&&(c=l),(0,h.jsxs)(p.xu,{children:[(0,h.jsx)(p.$j,{accessibilityLabel:this.props.i18n._('loading section picker', 'accessibility text for loading spinner', 'accessibility text for loading spinner'),show:!!o&&!o.isLoaded}),(!o||o&&o.isLoaded)&&(0,h.jsx)(i.Z,{createBtnDisabled:this.createBtnDisabled(),dropdownValue:c,isStoryPin:n,onCreate:a?null:this.handleSectionCreate,onSearchQueryUpdate:this.handleSearchQueryUpdate,onSelect:this.handleSectionSelected,renderRow:this.renderRow,searchQuery:s,sections:this.getPickerSections()})]})}}])&&m(t.prototype,n),o&&m(t,o),l}(o.Component);function D(e){var t=(0,u.ZP)();return(0,h.jsx)(E,g(g({},e),{},{dispatch:(0,r.useDispatch)(),i18n:t}))}function z(e){var t=(0,l.Z)({name:"BoardSectionsRepinResource",options:{board_id:e.board.id},noCache:!0});return(0,h.jsx)(D,g(g({},e),{},{sectionsResource:t}))}},916062:function(e,t,n){n.d(t,{Z:function(){return i}});var o=n(53987),r=n(609500);function i(e){var t=(0,r.useLocation)(),n=(0,r.useParams)(),i=(0,r.useHistory)();return function(){if(e&&(0,o.L6)(t)&&n.id===e.id){var r,a,l,s,c="quick_saves"===(null===(r=e.board)||void 0===r?void 0:r.layout)||"quick_creates"===(null===(a=e.board)||void 0===a?void 0:a.layout)?"/me/":null!==(l=null===(s=e.board)||void 0===s?void 0:s.url)&&void 0!==l?l:"/";i.replace(c)}}}},482567:function(e,t,n){n.d(t,{_:function(){return c}});var o=n(6637);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t,n,o,r,i,a){try{var l=e[i](a),s=l.value}catch(c){return void n(c)}l.done?t(s):Promise.resolve(s).then(o,r)}function s(e,t){return{type:"PIN_NOTE_UPDATE",payload:{pinId:e,pinNote:t}}}function c(e,t,n,r){return function(){var a,c=(a=regeneratorRuntime.mark((function a(l){var c,d,u;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(c=o.Z.create("ApiResource",{url:"/v3/pins/".concat(e,"/notes/"),data:i({pin_note_content:n},r?{orbac_subject_id:r}:Object.freeze({}))}),!n){a.next=13;break}if(!t){a.next=8;break}return a.next=5,c.callUpdate();case 5:d=a.sent,a.next=11;break;case 8:return a.next=10,c.callCreate();case 10:d=a.sent;case 11:a.next=16;break;case 13:return a.next=15,c.callDelete();case 15:d=a.sent;case 16:u=d.resource_response,l(s(e,null==u?void 0:u.data));case 18:case"end":return a.stop()}}),a)})),function(){var e=this,t=arguments;return new Promise((function(n,o){var r=a.apply(e,t);function i(e){l(r,n,o,i,s,"next",e)}function s(e){l(r,n,o,i,s,"throw",e)}i(void 0)}))});return function(e){return c.apply(this,arguments)}}()}},78120:function(e,t,n){n.d(t,{ZP:function(){return Je},Tr:function(){return Ke},aU:function(){return We}});var o=n(76911),r=n(506979),i=n(41233),a=n(678881),l=n.n(a),s=n(898781),c=n(908390),d=n(515198);function u(e){var t=e.commentsDisabled,n=e.onCommentChange,o=e.onPhotoChange,r=e.photosDisabled,i=e.isManagedView,a=e.isNoTitle,l=(0,s.ZP)(),u=i?6:a?0:3;return(0,d.jsxs)(c.xu,{children:[!a&&(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:i?0:4,paddingY:u,children:[!i&&!a&&(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",children:l._('Comment Permissions', 'Label for comments setting on a pin in pin edit form', 'Label for comments setting on a pin in pin edit form')})}),(0,d.jsxs)(c.xu,{column:12,mdColumn:i?12:8,children:[(0,d.jsxs)(c.xu,{paddingY:1,display:"flex",alignItems:"center","data-test-id":"allow-comments-switch",children:[(0,d.jsx)(c.rs,{onChange:n,id:"CommentSwitch",switched:!t}),(0,d.jsx)(c.xu,{paddingX:2,children:(0,d.jsx)(c.__,{htmlFor:"CommentSwitch",children:(0,d.jsx)(c.xv,{size:"200",children:l._('Allow people to comment', 'Label for toggling comments on a pin in pin edit form', 'Label for toggling comments on a pin in pin edit form')})})})]}),o&&(0,d.jsxs)(c.xu,{paddingY:1,alignItems:"center",display:"flex",children:[(0,d.jsx)(c.rs,{onChange:o,id:"PhotoSwitch",switched:!r}),(0,d.jsx)(c.xu,{paddingX:2,children:(0,d.jsx)(c.__,{htmlFor:"PhotoSwitch",children:(0,d.jsx)(c.xv,{size:"200",children:l._('Allow people to upload photos', 'Label for toggling photos on a pin in pin edit form', 'Label for toggling photos on a pin in pin edit form')})})})]})]})]})]})}var p=n(27255),h=n(653498),f=n.n(h),_=n(121151),g=n(274495),b=n(941646),y=n(499128),v=n(343341);function m(e){return(m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){D(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function P(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=E(e);if(t){var r=E(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return O(this,n)}}function O(e,t){if(t&&("object"===m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return A(e)}function A(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e){return(E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function D(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(i,e);var t,n,o,r=C(i);function i(){var e;P(this,i);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return D(A(e=r.call.apply(r,[this].concat(n))),"state",{deleting:!1}),D(A(e),"unmounted",!1),D(A(e),"handleConfirm",(function(){if(!e.state.deleting){var t=e.props.onDeletePin;e.setState({deleting:!0}),t().then((function(){return e.handleDeleteDidComplete()})).catch((function(t){return e.handleDeleteDidComplete(t)}))}})),D(A(e),"handleDeleteDidComplete",(function(t){var n=e.props.toastManagerContext;e.unmounted||e.setState({deleting:!1}),t||n.showToast((function(t){var n=t.hideToast;return(0,d.jsx)(y.ZP,{onHide:n,text:e.props.i18n._('Pin deleted!', 'User deleted their pin', 'User deleted their pin')})}))})),e}return t=i,(n=[{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"render",value:function(){var e=this.props,t=e.i18n,n=e.onDismiss,o=e.showStoryPinCreatorDeleteMessage,r=this.state.deleting;return(0,d.jsx)(_.ZP,{heading:t._('Are you sure?', 'Confirm the user wants to delete the pin', 'Confirm the user wants to delete the pin'),accessibilityModalLabel:t._('Are you sure you want to delete this pin?', 'Accessible label to confirm the user wants to delete the pin', 'Accessible label to confirm the user wants to delete the pin'),size:"sm",onDismiss:n,footer:(0,d.jsxs)(c.xu,{display:"flex",justifyContent:"center",marginStart:-1,marginEnd:-1,children:[(0,d.jsx)(c.xu,{paddingX:1,children:(0,d.jsx)(c.zx,{fullWidth:!0,onClick:n,text:t._('Cancel', ' - ', ' -- ')})}),(0,d.jsx)(c.xu,{paddingX:1,children:(0,d.jsx)(b.Z,{id:"confirm-delete-pin",children:(0,d.jsx)(g.Z,{onClick:this.handleConfirm,text:t._('Delete', 'PinEditModal.DeletePinConfirmation.DeleteButton', 'Delete button to delete a Pin'),submitting:r})})})]}),children:(0,d.jsx)(c.xu,{padding:4,display:"flex",justifyContent:"center",children:(0,d.jsx)(c.xv,{children:o?t._('If you delete this Pin, it\'ll be gone for good and those who\'ve saved it won\'t be able to view it.', 'PinEditModal.DeletePinConfirmation', 'Confirmation to delete a Pin that lets the creator know it will be unavailable to other Pinners who have saved it'):t._('Once you delete a Pin, you can\'t undo it!', ' - ', ' -- ')})})})}}])&&w(t.prototype,n),o&&w(t,o),i}(o.PureComponent);function k(e){var t=(0,s.ZP)();return(0,d.jsx)(z,j(j({},e),{},{i18n:t,toastManagerContext:(0,v.F9)()}))}function T(e){var t=e.canEdit,n=e.onAltTextChange,r=e.altText,i=(0,s.ZP)();return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"AltTextField",children:(0,d.jsx)(c.xv,{size:"200",children:i._('Alt text', 'EditPinModal.EditAltText', 'Label for editing alt text of pin')})})}),(0,d.jsx)(c.xu,{column:12,mdColumn:8,children:t?(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.xu,{children:(0,d.jsx)(c.nv,{id:"AltTextField",onChange:function(e){var t=e.value;return n({value:t.slice(0,500)})},size:"lg",value:r||""})}),(0,d.jsx)(c.xu,{children:(0,d.jsx)(c.__,{htmlFor:"AltTextField",children:(0,d.jsx)(c.xu,{marginTop:1,children:(0,d.jsx)(c.xv,{size:"200",color:"subtle",children:i._('This helps people using screen readers understand what your Pin is about.', 'EditPinModal.EditAltText', 'Label for editing alt text of pin')})})})})]}):(0,d.jsx)(c.xu,{column:12,mdColumn:8,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",weight:"bold",children:r})})})]})]})}var I=n(897103),R=n(990823);function M(e){var t=e.board,n=void 0===t?{}:t,o=e.canEdit,r=e.isOriginallyQuickCreatesBoard,i=e.onBoardChange,a=e.onBoardCreate,l=e.viewerId,u=(0,s.ZP)(),p=(0,R.ZP)(l).showEnabledSaveBehavior,h="quick_saves"===n.layout&&p,f="quick_creates"===n.layout;return(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"BoardPicker",children:(0,d.jsx)(c.xv,{size:"200",children:r?u._('Organize to a board (optional)', 'editPinModal.editBoard.optionalBoardLabel', 'Label for board dropdown to select optional board'):u._('Board', ' - ', ' -- ')})})}),o?(0,d.jsx)(c.xu,{column:12,mdColumn:8,"data-test-id":"edit-board",children:(0,d.jsx)(I.Z,{board:n,isBoardlessPinsBoard:h,isQuickCreatesBoard:f,onBoardChosen:i,onBoardCreate:a})}):n.name&&(0,d.jsx)(c.xu,{column:12,mdColumn:8,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",weight:"bold",children:n.name})})]})}var B=n(857752),F=n(43898),L=n(407043);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Q(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Y(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=G(e);if(t){var r=G(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return X(this,n)}}function X(e,t){if(t&&("object"===Z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return W(e)}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var q=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(a,e);var t,n,r,i=H(a);function a(){var e;Q(this,a);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return K(W(e=i.call.apply(i,[this].concat(n))),"state",{focused:!1}),K(W(e),"suggestionAnchorRef",(0,o.createRef)()),K(W(e),"handleBlur",(function(t){e.setState({focused:!1});var n=e.props.onBlur;n&&n(t)})),K(W(e),"handleFocus",(function(t){e.setState({focused:!0});var n=e.props.onFocus;n&&n(t)})),K(W(e),"handleChange",(function(t){var n=t.text,o=t.mentions;e.props.onDescriptionChange({value:n,userMentionTags:o})})),e}return t=a,(n=[{key:"render",value:function(){var e=this,t=this.props,n=t.canAddUserMentionTags,r=t.canEdit,i=t.description,a=t.errorMessage,l=t.initialMentions,s=t.label,u=t.placeholder,p=t.onDescriptionChange,h={__style:N({},this.state.focused?{boxShadow:"0 0 0 3px #92c2fb"}:{})};return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"DescriptionField",children:(0,d.jsx)(c.xv,{size:"200",children:s})})}),r?(0,d.jsxs)(c.xu,{column:12,mdColumn:8,children:[(0,d.jsx)(c.xu,{children:n?(0,d.jsx)(c.xu,{borderStyle:"lg",dangerouslySetInlineStyle:h,id:"DescriptionField",minHeight:48,paddingX:2,paddingY:4,ref:this.suggestionAnchorRef,role:"textbox",rounding:4,children:(0,d.jsx)(B.Z,{initialMentions:l,initialText:i,onAddMention:function(){e.props.logContextEvent({event_type:8905,element:116,aux_data:{tag_type:1}})},onBlur:this.handleBlur,onChange:this.handleChange,onFocus:this.handleFocus,onSearchMentionCancel:function(){e.props.logContextEvent({event_type:8908,element:116,aux_data:{tag_type:1}})},onSuggestionsPopoverOpen:function(){e.props.logContextEvent({event_type:8907,element:116,aux_data:{tag_type:1}})},maxSuggestions:4,placeholder:u})}):(0,d.jsx)(c.Kx,{id:"DescriptionField",placeholder:u,value:i,onChange:function(e){var t=e.value;p({value:t,userMentionTags:[]})},hasError:(a||"").length>0})}),!!a&&(0,d.jsx)(c.xu,{children:(0,d.jsx)(F.Z,{errorMessage:a,htmlFor:"pin-edit-description"})})]}):(0,d.jsx)(c.xu,{column:12,mdColumn:8,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",weight:"bold",children:i})})]})]})}}])&&Y(t.prototype,n),r&&Y(t,r),a}(o.Component);var J=function(e){var t=(0,L.v)().logContextEvent;return(0,d.jsx)(q,N(N({},e),{},{logContextEvent:t}))},$=n(356725),ee=n(239062),te=n(876371);function ne(e){var t,n=e.isCarousel,o=e.onMouseEnter,r=e.onMouseLeave,i=e.shouldShowCarouselSliders,a=e.onCarouselSlide,l=e.currentIndex,s=e.carouselData,u=e.pinId,p=e.description,h=e.image,f=void 0===h?{}:h;return(0,d.jsxs)(c.xu,{paddingX:4,paddingY:3,children:[n&&(t=s&&s.carousel_slots&&s.carousel_slots.length||1,t>=2&&(0,d.jsx)(c.xu,{padding:2,children:(0,d.jsx)(c.__,{htmlFor:"CardsIndex",children:(0,d.jsxs)(c.xv,{size:"200",children:[l+1,"/",t]})})})),(0,d.jsx)(c.zd,{width:236,children:(0,d.jsxs)(c.xu,{onMouseEnter:o,onMouseLeave:r,children:[(0,d.jsxs)(c.zd,{rounding:2,wash:!0,children:[n&&i&&(0,d.jsx)(c.xu,{display:"inlineBlock",height:"100%",position:"absolute",width:"100%",zIndex:new c.Ry(10),dangerouslySetInlineStyle:{__style:{background:"rgba(0, 0, 0, 0.3)"}},children:(0,d.jsx)(ee.default,{handleCarouselSwipe:a,carouselIndex:l,carouselData:s,pinId:u,isEditMode:!0})}),n?(0,d.jsx)(te.Z,{carouselIndex:l,isCloseup:!1,carouselData:s,pinId:u,isEditMode:!0}):(0,d.jsx)(c.Ee,{alt:p,color:"#efefef",naturalHeight:f.height,src:f.url,naturalWidth:f.width})]}),n&&(0,d.jsx)($.default,{carouselIndex:l,carouselData:s,pinId:u,handleCarouselSwipe:a,isEditMode:!0,variant:"legacy"})]})})]})}function oe(e){var t=e.apiErrorMessage,n=e.shouldShowGenericUpdateError,o=e.onClickDeleteButton,r=e.disableDelete,i=e.onHide,a=e.shouldDisableSave,l=e.triggerBoardAndSectionCreate,u=(0,s.ZP)();return(0,d.jsxs)(c.xu,{display:"flex",justifyContent:"between",marginStart:-1,marginEnd:-1,children:[(0,d.jsx)(b.Z,{id:"delete-pin-button",children:(0,d.jsx)(c.zx,{fullWidth:!0,text:u._('Delete', 'EditPinModal.EditPinFooter.Delete', 'delete pin'),onClick:o,disabled:r})}),n&&(0,d.jsx)(c.xu,{display:"flex",marginStart:2,marginTop:2,justifyContent:"center",children:(0,d.jsx)(F.Z,{errorMessage:t||u._('Sorry! There was an error editing your Pin.', 'EditPinModal.EditPinFooter.ErrorMessageToast', 'Toast for pin edit error'),htmlFor:"pin-edit-generic-error"})}),(0,d.jsxs)(c.xu,{display:"flex",justifyContent:"between",marginStart:-2,marginEnd:-2,children:[(0,d.jsx)(c.xu,{paddingX:2,children:(0,d.jsx)(c.zx,{fullWidth:!0,text:u._('Cancel', 'EditPinModal.EditPinFooter.Cancel', 'cancel changes'),onClick:i})}),(0,d.jsx)(c.xu,{paddingX:2,"data-test-id":"edit-pin-save",children:(0,d.jsx)(c.zx,{fullWidth:!0,text:u._('Save', 'EditPinModal.EditPinFooter.Save', 'save changes'),color:"red",onClick:l,disabled:a})})]})]})}function re(e){var t=e.pinNoteText,n=e.isCollaborative,r=e.onPinNoteChange,i=(0,s.ZP)();return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"PinNoteField",children:(0,d.jsx)(c.xv,{size:"200",children:n?i._('Note to group', 'editPinModal.editPinNote.groupTitle', 'Label for editing private note on group Pin'):i._('Note to self', 'editPinModal.editPinNote.title', 'Label for editing private note on Pin')})})}),(0,d.jsx)(c.xu,{column:12,mdColumn:8,paddingY:2,"data-test-id":"note-to-self-input",children:(0,d.jsx)(c.Kx,{errorMessage:t.length>=500?i._('Character limit reached', 'editPinModal.editPinNote.warningText', 'Text to inform user they have reached the length limit on Pin note'):void 0,id:"PinNoteField",onChange:r,placeholder:i._('Add a private note to remember your ideas about this Pin', 'editPinModal.editPinNote.placeholderText', 'Placeholder for editing private note'),value:t})})]})]})}var ie=n(241563);function ae(e){var t=e.board,n=e.canEdit,o=e.currentSection,r=e.onSectionChange,i=e.onSectionCreate,a=e.sectionId,l=e.sectionName,u=(0,s.ZP)(),p=null!=t&&t.id?ie.Z:ie.x;return"quick_creates"===(null==t?void 0:t.layout)?null:(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:3,children:(0,d.jsx)(c.__,{htmlFor:"SectionPicker",children:(0,d.jsx)(c.xv,{size:"200",children:u._('Section', 'label for editing a Pin\'s board section', 'label for editing a Pin\'s board section')})})}),n&&t?(0,d.jsx)(c.xu,{column:12,mdColumn:8,children:(0,d.jsx)(p,{board:t,onSectionChange:r,selectedSectionId:a,selectedSectionName:l,onSectionCreate:i})}):(0,d.jsx)(c.xu,{column:12,mdColumn:8,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",weight:"bold",children:o&&!(t||{}).is_collaborative?o.title:u._('No section', 'default dropdown option for selecting a board section on pin edit', 'default dropdown option for selecting a board section on pin edit')})})]})}function le(e){var t=e.canEdit,n=e.onTitleChange,r=e.title,i=e.errorMessage,a=(0,s.ZP)();return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"TitleField",children:(0,d.jsx)(c.xv,{size:"200",children:a._('Title', 'Label for editing title of pin', 'Label for editing title of pin')})})}),(0,d.jsx)(c.xu,{column:12,mdColumn:8,children:t?(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.xu,{"data-test-id":"pin-title-input",children:(0,d.jsx)(c.nv,{hasError:(i||"").length>0,id:"TitleField",onChange:n,size:"lg",value:r})}),!!i&&(0,d.jsx)(c.xu,{children:(0,d.jsx)(F.Z,{errorMessage:i,htmlFor:"pin-edit-title"})})]}):(0,d.jsx)(c.xu,{column:12,mdColumn:8,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",weight:"bold",children:r})})})]})]})}function se(e){var t=e.onChangeWebsite,n=e.link,r=e.errorMessage,i=(0,s.ZP)();return(0,d.jsxs)(o.Fragment,{children:[(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:3,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"WebsiteField",children:(0,d.jsx)(c.xv,{size:"200",children:i._('Website', ' - ', ' -- ')})})}),(0,d.jsxs)(c.xu,{column:12,mdColumn:8,children:[(0,d.jsx)(c.xu,{children:(0,d.jsx)(c.nv,{hasError:(r||"").length>0,id:"WebsiteField",onChange:t,size:"lg",value:n})}),!!r&&(0,d.jsx)(c.xu,{children:(0,d.jsx)(F.Z,{errorMessage:r,htmlFor:"pin-edit-website"})})]})]})]})}var ce,de=n(947599),ue=n(704217),pe=void 0!==ce?ce:ce=n(337148);function he(e){var t,n,r=e.onShoppingRecChange,i=e.shoppingRecDisabled,a=e.storyPinData,l=(0,s.ZP)(),u=(0,ue.useLazyLoadQuery)(pe,{});if(!u)return null;var p=(a||{}).has_product_pins,h=null===(t=u.v3GetCurrentUserHandlerQuery)||void 0===t||null===(n=t.data)||void 0===n?void 0:n.ipStelaRecDisabled;return(0,d.jsx)(o.Fragment,{children:(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,children:[(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",children:l._('Shopping recommendations', 'Heading for shopping recommendations permissions', 'shopping.recommendations')})}),(0,d.jsx)(c.xu,{column:12,mdColumn:8,children:(0,d.jsxs)(c.xu,{paddingY:1,display:"flex",alignItems:"start",children:[(0,d.jsx)(c.rs,{onChange:r,id:"PhotoSwitch",switched:!i,disabled:h||p}),(0,d.jsx)(c.xu,{paddingX:2,children:(0,d.jsx)(c.__,{htmlFor:"stelaSwitch",children:(0,d.jsxs)(c.kC,{alignItems:"stretch",justifyContent:"start",direction:"column",children:[(0,d.jsx)(c.xv,{size:"200",color:h?"subtle":"default",children:l._('Show similar products ', 'Label to toggle similar products on ideal pin', 'ideaPin.stela.toggle')}),h?(0,d.jsxs)(c.xv,{color:"subtle",size:"200",children:[l._('You\u2019ve disabled shopping recommendations for your profile ', 'Text indicating shopping recommendations are currently disabled', 'ideaPin.disable'),(0,d.jsx)(c.xv,{inline:!0,size:"200",weight:"bold",color:"subtle",children:(0,d.jsx)(c.rU,{display:"inlineBlock",href:"https://www.pinterest.com/settings/permissions",target:"blank",rel:"nofollow",underline:"hover",children:l._('Edit profile settings', 'Link to the settings page to enable shopping recommendations on idea pins', 'ideaPin.link')})})]}):(0,d.jsxs)(c.xu,{display:"flex",direction:"column",marginTop:1,children:[(0,d.jsx)(c.xu,{marginBottom:1,children:(0,d.jsx)(c.xv,{size:"200",children:l._('People can shop products similar to what\u2019s shown in this Idea Pin using visual search', 'Text indicating shopping recommendations are currently enabled', 'ideaPin.enable')})}),(0,d.jsx)(c.xv,{size:"200",children:l._('Shopping recommendations aren\u2019t available for Idea ads and Idea Pins with product tags or paid partnership label', 'Explanation about how stela on idea pins with tagged products arent available', 'ideaPin.tagged.unavailable')})]})]})})})]})})]})})}function fe(e){var t=e.shoppingRecDisabled,n=e.onShoppingRecChange,r=e.isNoTitle,i=(0,s.ZP)();return(0,d.jsxs)(o.Fragment,{children:[!r&&(0,d.jsx)(c.iz,{}),(0,d.jsxs)(c.xu,{mdDisplay:"flex",justifyContent:"between",paddingX:4,paddingY:r?0:3,children:[!r&&(0,d.jsx)(c.xu,{column:12,mdColumn:3,paddingY:2,children:(0,d.jsx)(c.xv,{size:"200",children:i._('Recommendations', 'EditPinModal.recommendations', 'Title of a section in the edit pin modal to manage recommendations on a specific pin.')})}),(0,d.jsx)(c.xu,{column:12,mdColumn:8,children:(0,d.jsxs)(c.xu,{paddingY:1,display:"flex",alignItems:"center",children:[(0,d.jsx)(c.rs,{onChange:n,id:"ShoppingRecSwitch",switched:!t}),(0,d.jsx)(c.xu,{paddingX:2,children:(0,d.jsx)(c.__,{htmlFor:"ShoppingRecSwitch",children:(0,d.jsx)(c.xv,{size:"200",children:i._('Show shopping recommendations', 'EditPinModal.recommendations.showShoppingRecommendations.label', 'Label for toggling showing shopping recommendations on a specific pin.')})})})]})})]})]})}var _e=n(717615),ge=n(916062),be=n(784590),ye=n(19121),ve=n(422946),me=n(956800),xe=n(482567),je=n(90326),Pe=n(825067),we=n(6637),Se=n(827896),Ce=n(254176),Oe=n(947729),Ae=n(231947),Ee=n(780280),De=n(821463),ze=n(678638),ke=n(414327),Te=n(134906),Ie=n(563339),Re=n(609500);function Me(e){return(Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Fe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){He(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ze(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function Ue(e,t){return(Ue=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=Ve(e);if(t){var r=Ve(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return Qe(this,n)}}function Qe(e,t){if(t&&("object"===Me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Ye(e)}function Ye(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ve(e){return(Ve=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function He(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xe(e){return Boolean(e&&e.trim().length)}function We(e,t){var n=Xe(e),o=Xe(t);return(n||o)&&e!==t}var Ge=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ue(e,t)}(a,e);var t,n,o,r=Ne(a);function a(){var e,t,n,o,i,s,c,d,u,h,_,g,b,y,v,m,x,j,P,w;Le(this,a);for(var S=arguments.length,C=new Array(S),O=0;O<S;O++)C[O]=arguments[O];return He(Ye(w=r.call.apply(r,[this].concat(C))),"state",{altText:(null===(e=w.props.pinResource.data)||void 0===e?void 0:e.alt_text)||"",board:(null===(t=w.props.pinResource.data)||void 0===t?void 0:t.board)||null,commentsDisabled:(null===(n=w.props.pinResource.data)||void 0===n?void 0:n.comments_disabled)||(null===(o=w.props.pinResource.data)||void 0===o?void 0:o.did_it_disabled)||!1,description:(null===(i=w.props.pinResource.data)||void 0===i||null===(s=i.description)||void 0===s?void 0:s.trim())||"",apiErrorMessage:null,link:(null===(c=w.props.pinResource.data)||void 0===c?void 0:c.link)||"",pinNoteText:(null===(d=w.props.pinResource.data)||void 0===d||null===(u=d.pin_note)||void 0===u?void 0:u.text)||"",sectionId:(null===(h=w.props.pinResource.data)||void 0===h||null===(_=h.section)||void 0===_?void 0:_.id)||null,sectionName:(null===(g=w.props.pinResource.data)||void 0===g||null===(b=g.section)||void 0===b?void 0:b.title)||null,showDeleteConfirmation:!1,carousel_data:(null===(y=w.props.pinResource.data)||void 0===y?void 0:y.carousel_data)||null,title:(null===(v=w.props.pinResource.data)||void 0===v?void 0:v.title)||"",isLoadingPin:!Boolean(w.props.pinResource.isLoaded),isProcessing:!1,currentIndex:void 0!==w.props.carouselSlotCurrentIndex?w.props.carouselSlotCurrentIndex:(null===(m=w.props.pinResource.data)||void 0===m||null===(x=m.carousel_data)||void 0===x?void 0:x.index)||0,shoppingRecDisabled:null===(j=w.props.pinResource.data)||void 0===j?void 0:j.shopping_rec_disabled,shouldApplyTextToAll:!1,shouldDisableSave:!1,shouldShowCarouselSliders:!1,shouldShowValidationTitleError:!1,shouldShowValidationDescriptionError:!1,shouldShowValidationLinkFormatError:!1,shouldShowGenericUpdateError:!1,shouldShowValidationUserMentionTagsError:!1,userMentionTags:(null===(P=w.props.pinResource.data)||void 0===P?void 0:P.user_mention_tags)||[]}),He(Ye(w),"onClickDeleteButton",(function(){return w.setState({showDeleteConfirmation:!0})})),He(Ye(w),"onHideConfirmation",(function(){return w.setState({showDeleteConfirmation:!1})})),He(Ye(w),"updateCarouselSlotIndex",(function(){var e=w.props.carouselSlotCurrentIndex;w.setState({currentIndex:void 0!==e?e:w.props.pinResource.data&&w.props.pinResource.data.carousel_data&&w.props.pinResource.data.carousel_data.index||0})})),He(Ye(w),"handleBoardChange",(function(e){var t=w.state.board.id;e.id!==t&&w.setState({board:e,sectionId:null,sectionName:null})})),He(Ye(w),"createBoard",(function(e){var t=w.props,n=t.createBoard,o=t.viewer,r=t.orbacActingAs,i=w.state.board,a=(0,Ae.lJ)(o,r);!i.id&&i.name&&e&&n(i.name,e,a).then((function(e){if(w._isMounted){var t=w.state,n=t.sectionId,o=t.sectionName;!n&&o?(w.setState({board:e}),w.createSection()):(w.handleBoardChange(e),w.handleSave())}}))})),He(Ye(w),"handleBoardCreateClick",(function(e){if(e){var t={name:e,privacy:p.Z.BoardPrivacy.PUBLIC,access:"write"};w.setState({board:t,sectionId:null,sectionName:null})}})),He(Ye(w),"createSection",(function(){var e=w.state,t=e.board,n=e.sectionName,o=w.props,r=o.viewer,i=o.orbacActingAs,a=(0,Ae.lJ)(r,i);if(n)if(t.id){var l={boardId:t.id,name:n};(0,w.props.createSection)(l,a).then((function(e){w._isMounted&&(w.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null}),w.handleSave())})).catch((function(){w.setState({shouldShowGenericUpdateError:!0,apiErrorMessage:null})}))}else w.createBoard()})),He(Ye(w),"handleSectionCreateClick",(function(e){0!==e.length&&(w.state.board&&w.setState({sectionId:null,sectionName:e}))})),He(Ye(w),"handleSectionChange",(function(e){return w.setState({sectionId:e&&e.id||null,sectionName:e&&e.title||null,shouldShowGenericUpdateError:!1})})),He(Ye(w),"handleDeletePin",(function(){var e=w.props,t=e.advertiser_id,n=e.changeBoardPinCount,o=e.changeUserPinCount,r=e.dispatch,i=e.getClientTrackingParams,a=e.onDelete,l=e.onHide,s=e.orbacActingAs,c=e.pinId,d=e.pinResource.data,u=e.removeBoardlessPin,p=e.viewer,h=(0,Ae.lJ)(p,s),f=Fe(Fe(Fe({},t?{advertiser_id:t}:{}),h?{orbac_subject_id:h}:Object.freeze({})),{},{id:c,client_tracking_params:i(c)});return we.Z.create("PinResource",f).callDelete().then((function(){if(w._isMounted){if(!d)return;var e=d.board,t=(e=void 0===e?{}:e).id,i=d.pinner,s=(i=void 0===i?{}:i).id,h=d.section,f=null==h?void 0:h.id;n({boardId:t,sectionId:f,increment:-1}),o({userId:s,increment:-1}),r((0,Ce.xQ)(t)),r((0,me.EX)({feedId:f||t,feedType:f?ve.DV.BOARD_SECTION_PINS:ve.DV.BOARDFEED,itemIds:[c],itemType:"pin"})),r((0,me.EX)({feedId:s,feedType:ve.DV.STORY_PINS_FEED,itemIds:[c],itemType:"pin"})),r((0,me.EX)({feedId:s,feedType:ve.DV.PROFILE_PINS_FEED,itemIds:[c],itemType:"pin"})),f&&r((0,ze.CE)(f)),l(),a&&a()}p.id&&u(p.id,c)}))})),He(Ye(w),"sanitizeCarouselData",(function(e){var t=w.state.carousel_data;if(e&&(t=e),t){var n=t.carousel_slots;if(n){var o={carousel_slots:[]};return n.forEach((function(e){var t={description:e.details||"",title:e.title||"",link:e.link||""};o.carousel_slots.push(t)})),o}}return null})),He(Ye(w),"triggerBoardAndSectionCreate",(function(e){return function(){var t=w.state,n=t.board,o=t.sectionId,r=t.sectionName;n&&!n.id&&n.name?w.createBoard(e):!o&&r?w.createSection():w.handleSave()}})),He(Ye(w),"logPinEditEvent",(function(e,t,n,o,r){var i={},a=w.props,l=a.pinId,s=a.view,c=a.viewParameter,d=w.state.userMentionTags;if(i.objectId=l,i.num_user_mention_tags=d.length,e&&(i.board_was_modified=!0),!e&&t&&(i.board_section_was_modified=!0),n){var u=w.state.description,p=r.description;i.original_pin_description=p,i.edited_pin_description=u}if(o){var h=w.state.carousel_data,f=r.carousel_data;i.original_carousel_data=JSON.stringify(w.sanitizeCarouselData(f)),i.edited_carousel_data=JSON.stringify(w.sanitizeCarouselData(h))}w.props.logContextEvent({event_type:2,component:208,view_type:s,view_parameter:c,aux_data:Fe({},i)})})),He(Ye(w),"handleSave",(function(){w.setState({apiErrorMessage:null,isProcessing:!0});var e=w.props,t=e.advertiser_id,n=e.completeResourceFetch,o=e.invalidatePinResource,r=e.orbacActingAs,i=e.pinId,a=e.pinResource.data,l=e.onHide,s=e.removeBoardlessPin,c=e.updatePinNote,d=e.viewer;if(a){var u,p=a.alt_text,h=a.board,_=a.comments_disabled,g=a.did_it_disabled,b=a.title,y=a.description,v=a.link,m=a.pin_note,x=a.section,j=a.carousel_data,P=a.shopping_rec_disabled,S=null==m?void 0:m.text,C=w.state,O=C.carousel_data,A=C.shouldShowValidationLinkFormatError;if(O){var E=w.sanitizeCarouselData();E&&(u=JSON.stringify(E))}var D=w.state,z=D.altText,k=D.board,T=D.commentsDisabled,I=D.currentIndex,R=D.title,M=D.description,B=D.pinNoteText,F=D.sectionId,L=D.shoppingRecDisabled,Z=D.carousel_data,U=D.userMentionTags,N=k||h,Q=A?v:w.state.link,Y=(0,Ae.lJ)(d,r),V=Fe(Fe({alt_text:z,board_id:null==N?void 0:N.id,board_section_id:F,carousel_data_json:u,description:M,disable_comments:T,disable_did_it:T,id:i,link:Q,shopping_rec_disabled:L,title:R,user_mention_tags:JSON.stringify(U)},t?{advertiser_id:t}:{}),Y?{orbac_subject_id:Y}:Object.freeze({})),H=x&&x.id||null,X=null==N?void 0:N.id,W=null==h?void 0:h.id,G=We(p,z),K=W!==X,q=(Boolean(H)||Boolean(F))&&H!==F,J=We(b,R),$=We(y,M),ee=We(v,Q),te=Boolean(Z)&&Boolean(j)&&!f()(Z,j),ne=_!==T||g!==T,oe=We(S,B);G||K||q||J||$||oe||ee||te||ne||P!==L?(oe&&c(i,S,B,Y),we.Z.create("PinResource",V).callUpdate().then((function(e){if(w._isMounted){var t,r,i,c=w.props,u=c.changeBoardPinCount,p=c.onSubmit,h=c.pinId,f=c.pinMoved;if((K||q)&&X&&W)f({selectedPinIds:[h],source:{boardId:W,sectionId:H},target:{boardId:X,sectionId:F}}),u({boardId:X,sectionId:F||void 0,increment:1}),u({boardId:W,sectionId:H||void 0,increment:-1}),d.id&&"quick_saves"===(null===(r=a.board)||void 0===r?void 0:r.layout)&&s(d.id,h);if(p&&X&&null!=N&&N.url)p({boardId:X,title:null!==(i=N.name)&&void 0!==i?i:"",sectionId:F,url:N.url});l(),o(h,Y),null!==(t=e.resource_response)&&void 0!==t&&t.data.carousel_data&&(e.resource_response.data.carousel_data.index=I),n(e,Y),w.logPinEditEvent(K,q,$,te,a)}})).catch((function(){var e=w.state,t=e.shouldShowValidationTitleError,n=e.shouldShowValidationDescriptionError,o=e.shouldShowValidationLinkFormatError;w.setState({isProcessing:!1,shouldShowGenericUpdateError:!t&&!n&&!o})}))):(l(),o(i,Y)),w.setState({isProcessing:!1})}})),He(Ye(w),"handleTextChanges",(function(e,t){var n=w.state.carousel_data;if(n){var o=l()(n),r=o.carousel_slots,i=void 0===r?[]:r,a=w.state,s=a.currentIndex,c=a.shouldApplyTextToAll,d=a.description,u=a.link,p=a.title,h=w.valueIsValidForType(e,t);switch(c?i.forEach((function(n){return n[t]=e})):i[s]&&(i[s][t]=e),t){case"details":var f=0===s?e:d;w.setState({description:f,carousel_data:o||null,shouldShowValidationDescriptionError:!h,shouldShowGenericUpdateError:!1});break;case"link":var _=0===s?e:u;w.setState({link:_,carousel_data:o||null,shouldShowValidationLinkFormatError:!h,shouldShowGenericUpdateError:!1});break;case"title":var g=0===s?e:p;w.setState({title:g,carousel_data:o||null,shouldShowValidationTitleError:!h,shouldShowGenericUpdateError:!1})}}})),He(Ye(w),"handleDescriptionChange",(function(e){var t=e.value,n=e.userMentionTags,o=w.valueIsValidForType(t,"description"),r=n.length<=5;n.length<w.state.userMentionTags.length&&w.props.logContextEvent({event_type:8906,element:116,aux_data:{tag_type:1}}),w.setState({description:t,userMentionTags:n,shouldShowValidationDescriptionError:!o,shouldShowValidationUserMentionTagsError:!r,shouldShowGenericUpdateError:!1})})),He(Ye(w),"handleCarouselDetailsChange",(function(e){var t=e.value;w.handleTextChanges(t,"details")})),He(Ye(w),"handleTitleChange",(function(e){var t=e.value,n=w.valueIsValidForType(t,"title");w.setState({title:t,shouldShowValidationTitleError:!n,shouldShowGenericUpdateError:!1})})),He(Ye(w),"handleCarouselTitleChange",(function(e){var t=e.value;w.handleTextChanges(t,"title")})),He(Ye(w),"handleAltTextChange",(function(e){var t=e.value;w.setState({altText:t})})),He(Ye(w),"valueIsValidForType",(function(e,t){switch(t){case"details":case"description":return e.length<=500;case"link":return e.length>=0&&0===(0,Te.FU)([(0,Te.Jx)({message:w.props.i18n._('Not a valid url.', 'Validation error for an improperly formated url', 'Validation error for an improperly formated url')})],e).length;case"title":return e.length<=100;default:return!0}})),He(Ye(w),"handleWebsiteChange",(function(e){var t=e.value,n=w.valueIsValidForType(t,"link");w.setState({link:t,shouldDisableSave:!n,shouldShowValidationLinkFormatError:!n,shouldShowGenericUpdateError:!1})})),He(Ye(w),"handleCarouselWebsiteChange",(function(e){var t=e.value;w.handleTextChanges(t,"link")})),He(Ye(w),"handleCommentChange",(function(e){return w.setState({commentsDisabled:!e.value})})),He(Ye(w),"handleShoppingRecChange",(function(e){w.setState({shoppingRecDisabled:!e.value})})),He(Ye(w),"handleShouldApplyToAll",(function(e){if(e){var t=w.state,n=t.currentIndex,o=void 0===n?0:n,r=t.carousel_data;if(!r)return;var i=l()(r),a=i.carousel_slots,s=void 0===a?[]:a,c=s[o],d=c.details,u=c.link,p=c.title;s.forEach((function(e){e.details=d,e.title=p,e.link=u})),w.setState({carousel_data:i,shouldApplyTextToAll:e})}else w.setState({shouldApplyTextToAll:e})})),He(Ye(w),"handleCarouselSlider",(function(e){var t=w.state.carousel_data,n=t&&t.carousel_slots&&t.carousel_slots.length||1;e>=0&&e<n&&w.setState({currentIndex:e})})),He(Ye(w),"handleMouseEnter",(function(){w.setState({shouldShowCarouselSliders:!0})})),He(Ye(w),"handleMouseLeave",(function(){w.setState({shouldShowCarouselSliders:!1})})),w}return t=a,(n=[{key:"componentDidMount",value:function(){this._isMounted=!0,this.updateCarouselSlotIndex()}},{key:"componentDidUpdate",value:function(e){var t,n=this.props,o=n.pinResource,r=o.data,i=o.isLoaded,a=n.carouselSlotCurrentIndex;r&&i!==e.pinResource.isLoaded&&this.setState({altText:r.alt_text,board:r.board,commentsDisabled:r.comments_disabled||r.did_it_disabled,description:r.description&&r.description.trim(),isLoadingPin:!1,link:r.link,pinNoteText:(null===(t=r.pin_note)||void 0===t?void 0:t.text)||"",sectionId:(r.section||{}).id,sectionName:(r.section||{}).title,title:r.title,carousel_data:r.carousel_data,currentIndex:void 0!==a?a:r.carousel_data&&r.carousel_data.index||0,shouldApplyTextToAll:!1,userMentionTags:r.user_mention_tags||[],shoppingRecDisabled:r.shopping_rec_disabled})}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"getCurrentUserId",value:function(e){return e.isAuth?e.id:""}},{key:"render",value:function(){var e,t,n,o=this,r=this.props,a=r.disableDelete,l=r.onHide,s=r.orbacActingAs,p=r.pinResource,h=r.pinId,f=r.viewer,g=this.state,b=g.altText,y=g.apiErrorMessage,v=g.board,m=g.commentsDisabled,x=g.description,j=g.link,P=g.pinNoteText,w=g.sectionId,S=g.sectionName,C=g.showDeleteConfirmation,O=g.title,A=g.isLoadingPin,E=g.isProcessing,D=g.carousel_data,z=g.shouldApplyTextToAll,I=g.currentIndex,R=g.shoppingRecDisabled,B=g.shouldDisableSave,F=g.shouldShowCarouselSliders,L=g.shouldShowValidationTitleError,Z=g.shouldShowValidationDescriptionError,U=g.shouldShowValidationLinkFormatError,N=g.shouldShowGenericUpdateError,Q=g.shouldShowValidationUserMentionTagsError,Y=g.userMentionTags,V=p.data||{},H=!!(V&&V.story_pin_data_id&&V.story_pin_data),X=(null===(e=V.native_creator)||void 0===e?void 0:e.id)===this.getCurrentUserId(f);if(C)return(0,d.jsx)(k,{onDeletePin:this.handleDeletePin,onDismiss:this.onHideConfirmation,showStoryPinCreatorDeleteMessage:H&&X});var W=!!(D&&D.carousel_slots&&D.carousel_slots.length>1),G=D&&D.carousel_slots&&D.carousel_slots.length>0&&D.carousel_slots[I]||{},K=G.details,q=void 0===K?"":K,$=G.link,ee=void 0===$?"":$,te=G.title,ie=void 0===te?"":te,ce=V&&(V.access||[]).includes("write")||this.props.canEdit||!!v&&(0,i.Z)({action:4,board:v,viewer:f})||!!v&&(0,Ae.KY)(f,v,s),ue=function(e){var t=(0,Ae.lJ)(e,s),n=t||o.getCurrentUserId(e),r=o.props.canEdit&&o.props.advertiserOwnerUserId?o.props.advertiserOwnerUserId:n;return ce&&!V.is_repin&&!H&&(W||!D)&&(V.native_creator&&V.native_creator.id===r||W&&V.pinner&&V.pinner.id===r||V.link_domain&&V.link_domain.official_user&&V.link_domain.official_user.id===r||!!V.domain&&V.pinner&&V.pinner.id===r&&V.pinner.domain_url&&V.pinner.domain_url.includes(V.domain))},pe=V&&V.images&&V.images["474x"]||{},_e=H&&!!V.story_pin_data&&X,ge=ue(f)?(0,d.jsx)(le,{canEdit:ce,onTitleChange:W?this.handleCarouselTitleChange:this.handleTitleChange,title:W&&ie?ie:O,errorMessage:L?(0,Oe.Y8)(W,this.props.i18n):""}):null,be=(ce||f.isAuth&&(V.pinner||{}).id===f.id)&&ue(f)?(0,d.jsx)(J,{canAddUserMentionTags:!W,canEdit:ce,description:(W?q:x)||"",errorMessage:Z?(0,Oe.MM)(W,o.props.i18n):Q?(0,Oe.bl)(W,o.props.i18n):"",initialMentions:Y,label:this.props.i18n._('Description', 'Label for editing description', 'Label for editing description'),placeholder:this.props.i18n._('Tell us about this Pin...', 'Placeholder for editing description', 'Placeholder for editing description'),onDescriptionChange:W?this.handleCarouselDetailsChange:this.handleDescriptionChange}):null,ye=(0,d.jsx)(re,{isCollaborative:!(null==v||!v.is_collaborative),onPinNoteChange:function(e){var t=e.value;o.setState({pinNoteText:t})},pinNoteText:P}),ve=function(e){return ue(e)&&!(V.aggregated_pin_data&&V.aggregated_pin_data.is_shop_the_look)}(f)?(0,d.jsx)(se,{link:W&&ee?ee:j,onChangeWebsite:W?this.handleCarouselWebsiteChange:this.handleWebsiteChange,errorMessage:U?(0,Oe.qj)(W,this.props.i18n):""}):null,me=W?(0,d.jsxs)(c.xu,{display:"flex",justifyContent:"end",paddingX:4,paddingY:3,alignItems:"end",children:[(0,d.jsx)(c.xu,{paddingY:2,children:(0,d.jsx)(c.__,{htmlFor:"applyTextToAll",children:(0,d.jsx)(c.xv,{children:this.props.i18n._('Apply text to all', 'Apply title, description, link to all cards', 'Apply title, description, link to all cards')})})}),(0,d.jsx)(c.xu,{paddingX:2,paddingY:2,children:(0,d.jsx)(c.rs,{onChange:function(e){return o.handleShouldApplyToAll(e.value)},id:"applyTextToAll",switched:z})})]}):null,xe=ue(f)?(0,d.jsx)(T,{canEdit:ce,onAltTextChange:this.handleAltTextChange,altText:b}):null,je=V.can_delete_did_it_and_comments?(0,d.jsx)(u,{commentsDisabled:m,onCommentChange:this.handleCommentChange}):null,Pe=!f.isAuth||(null===(t=V.pinner)||void 0===t?void 0:t.id)!==f.id||V.is_repin||V.story_pin_data||f.shopping_rec_disabled?null:(0,d.jsx)(fe,{shoppingRecDisabled:R,onShoppingRecChange:this.handleShoppingRecChange}),we=!!(0,Ae.lJ)(f,s),Se=!!f.has_quicksave_board&&!!f.boardCount&&f.boardCount<2&&!we&&!this.props.advertiserOwnerUserId,Ce="quick_creates"===(null===(n=V.board)||void 0===n?void 0:n.layout),Ee=(0,Ae.Ms)(f,s);return(0,d.jsx)(_.ZP,{heading:this.props.i18n._('Edit this Pin', 'EditPinModal.ModalHeading.EditThisPin', 'Edit a previously saved pin'),accessibilityModalLabel:this.props.i18n._('Edit your previously saved pin', 'EditPinModal.ModalHeading.AccessibleLabel', 'Accessible label for edit previously saved pin modal'),size:Se?"sm":"lg",onDismiss:l,footer:(0,d.jsx)(oe,{apiErrorMessage:y,shouldShowGenericUpdateError:N,onClickDeleteButton:this.onClickDeleteButton,disableDelete:!ce||a,onHide:l,shouldDisableSave:B,triggerBoardAndSectionCreate:this.triggerBoardAndSectionCreate(Ee)}),children:A||!p.isLoaded||E?(0,d.jsx)(c.kC,{alignItems:"center",justifyContent:"center",children:(0,d.jsx)(c.$j,{accessibilityLabel:this.props.i18n._('loading', 'EditPinModal.LoadingPin.Spinner', 'Accessible label for the edit pin loading icon'),show:!0})}):(0,d.jsxs)(c.xu,{display:"flex",justifyContent:Se?"center":"between",minHeight:350,paddingX:4,children:[Se?null:(0,d.jsxs)(c.xu,{column:12,mdColumn:9,children:[(0,d.jsx)(M,{board:v||V.board,canEdit:ce,isOriginallyQuickCreatesBoard:Ce,onBoardChange:this.handleBoardChange,onBoardCreate:this.handleBoardCreateClick,viewerId:f.id||""}),(0,d.jsx)(ae,{board:v||V.board,canEdit:ce,onSectionCreate:this.handleSectionCreateClick,onSectionChange:this.handleSectionChange,sectionId:w,sectionName:S,currentSection:V.section}),ge,be,ve,me,xe,ye,je,Pe,_e&&(0,d.jsx)(de.Z,{children:(0,d.jsx)(he,{onShoppingRecChange:this.handleShoppingRecChange,shoppingRecDisabled:R,storyPinData:V.story_pin_data})})]}),(0,d.jsx)(ne,{isCarousel:W,shouldShowCarouselSliders:F,onCarouselSlide:this.handleCarouselSlider,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,currentIndex:this.state.currentIndex,carouselData:this.state.carousel_data,pinId:h,description:x,image:pe})]})})}}])&&Ze(t.prototype,n),o&&Ze(t,o),a}(o.Component),Ke=function(e,t,n){return Fe({field_set_key:"detailed",id:e,preserve_component_state:t},n?{orbac_subject_id:n}:Object.freeze({}))},qe=(0,r.connect)(null,(function(e,t){return{changeBoardPinCount:function(t){return e((0,Ce.Br)(t))},changeUserPinCount:function(t){return e((0,je.JS)(t))},completeResourceFetch:function(t,n){return e((0,ke.Sr)("PinResource",Ke(t.resource_response.data.id,!1,n),t))},createBoard:function(t,n,o){return e((0,Ce.aX)(t,n,o))},createSection:function(n,o){return e((0,ze.vB)(n,t.i18n,o))},invalidatePinResource:function(t,n){return e((0,ke.jB)("PinResource",Ke(t,!0,n)))},removeBoardlessPin:function(t,n){return e((0,me.EX)({feedId:t,feedType:ve.DV.BOARDLESS_PINS,itemIds:[n],itemType:"pin"}))},pinMoved:(0,De.bindActionCreators)(Ie.S,e),updatePinNote:function(t,n,o,r){return e((0,xe._)(t,n,o,r))}}}))(Ge);function Je(e){var t,n=(0,s.ZP)(),o=(0,L.v)().logContextEvent,i=(0,r.useSelector)((function(e){return e.advertiser})),a=null===(t=(0,Pe.W)())||void 0===t?void 0:t.onPinDelete,l=(0,_e.Z)(),c=(0,ye.Z)(),u=(0,Ae.lJ)(c,l),p=(0,be.Z)({name:"PinResource",options:Ke(e.pinId,!0,u)}),h=(0,Se.Z)(),f=c.isAuth&&Boolean(i)?i.id:void 0,_=c.isAuth&&Boolean(i)&&i.owner_user_id!==c.id?i.owner_user_id:void 0,g=(0,ge.Z)(p.data);return(0,d.jsx)(qe,Fe(Fe({},e),{},{advertiser_id:f,advertiserOwnerUserId:_,getClientTrackingParams:h,dispatch:(0,r.useDispatch)(),history:(0,Re.useHistory)(),i18n:n,logContextEvent:o,onDelete:function(){var t;g(),null===(t=e.onDelete)||void 0===t||t.call(e),a&&a({pinId:e.pinId})},orbacActingAs:l,pinResource:p,requestContext:(0,Ee.B)(),viewer:c}))}},947729:function(e,t,n){function o(e,t){return e?t._('Title too long. Make sure all cards\' titles have less than 100 characters', 'Title entered is too long while editing a carousel pin and/or one of its pins', 'Title entered is too long while editing a carousel pin and/or one of its pins'):t._('Title too long. Make sure title has less than 100 characters', 'Title entered is too long while editing a pin', 'Title entered is too long while editing a pin')}function r(e,t){return e?t._('Description too long. Make sure all cards\' descriptions have less than 500 characters', 'Description entered is too long while editing a carousel pin and/or one of its pins', 'Description entered is too long while editing a carousel pin and/or one of its pins'):t._('Description too long. Make sure description has less than 500 characters', 'Description entered is too long while editing a pin', 'Description entered is too long while editing a pin')}function i(e,t){return t._('Too many mentions. Make sure you have at most 5.', 'editPinModal.errorMessages.userMentionOverLimit', 'Too many mentions used in the description')}function a(e,t){return e?t._('Need to provide a valid URL. Make sure all cards\' links are valid', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins', 'Invalid URL/link provided while editing a carousel pin and/or one of its pins'):t._('Need to provide a valid URL. Make sure the link is valid', 'Invalid URL/link provided while editing a pin', 'Invalid URL/link provided while editing a pin')}n.d(t,{MM:function(){return r},Y8:function(){return o},bl:function(){return i},qj:function(){return a}})}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/78120-d5cded0a99d4c970.js.map